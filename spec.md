# Gantty 仕様書

## 概要

Ganttyは、WBS（作業分解構造）とガントチャートを統合したプロジェクト管理ツールです。チームでのプロジェクト計画・進捗管理を支援します。

## 技術スタック

- **フレームワーク**: Tauri v2
- **フロントエンド**: React + TypeScript
- **UIライブラリ**: 未定（shadcn/ui等を推奨）
- **状態管理**: 未定（Zustand等を推奨）
- **ファイル形式**: JSON（`.gantty`拡張子）

## 機能一覧

### Phase 1: MVP（WBS + ガントチャート基本機能）

#### WBS機能
- [ ] 階層構造のタスク管理（親子関係）
- [ ] タスクの基本属性
  - タスク名
  - 開始日・終了日
  - 工数（予定/実績）
  - 進捗率（0-100%）
  - 担当者
- [ ] タスクの追加・編集・削除
- [ ] タスクの並び替え（ドラッグ&ドロップ）
- [ ] タスクの折りたたみ/展開

#### ガントチャート表示
- [ ] 日/週/月の表示スケール切り替え
- [ ] タスクバーの表示
- [ ] 進捗率の視覚的表示（バー内の塗りつぶし）
- [ ] 今日の日付ライン表示
- [ ] 横スクロール・縦スクロール対応

#### ガントチャート編集
- [ ] バーのドラッグ&ドロップによる日程変更
- [ ] バーの端をドラッグして期間変更

#### ファイル操作
- [ ] 新規プロジェクト作成
- [ ] プロジェクトの保存（`.gantty`形式）
- [ ] プロジェクトの読み込み
- [ ] 自動保存機能

### Phase 2: 依存関係・マイルストーン

#### 依存関係
- [ ] 依存関係の種類
  - FS（終了-開始）: 前タスク終了後に開始
  - SS（開始-開始）: 前タスク開始と同時に開始
  - FF（終了-終了）: 前タスク終了と同時に終了
  - SF（開始-終了）: 前タスク開始後に終了
- [ ] ラグ/リードタイム設定（+/-日数）
- [ ] 依存関係の矢印表示
- [ ] 依存関係に基づく日程自動調整

#### マイルストーン
- [ ] マイルストーンの作成（期間0日のタスク）
- [ ] マイルストーン専用アイコン表示（◆）
- [ ] マイルストーンへの依存関係設定

#### クリティカルパス
- [ ] クリティカルパスの自動計算
- [ ] クリティカルパス上のタスクをハイライト表示

### Phase 3: リソース管理

#### リソースマスタ
- [ ] リソース（担当者）の登録・編集・削除
- [ ] リソース属性
  - 名前
  - 表示色
  - 稼働率（デフォルト100%）

#### リソース割り当て
- [ ] タスクへのリソース割り当て（複数可）
- [ ] 割り当て率の設定（例: 50%）

#### 負荷表示
- [ ] リソース別の負荷グラフ表示
- [ ] 過負荷（100%超）の警告表示

### Phase 4: カレンダー・カスタムフィールド

#### カレンダー設定
- [ ] 非稼働日の設定（土日デフォルト）
- [ ] 祝日・休日の個別設定
- [ ] 非稼働日をグレー表示
- [ ] 工数計算に非稼働日を反映

#### カスタムフィールド
- [ ] カスタムフィールドの追加
  - テキスト
  - 数値
  - 日付
  - 選択肢（ドロップダウン）
  - チェックボックス
- [ ] WBS一覧での表示列カスタマイズ

#### タグ機能
- [ ] タグの作成（名前・色）
- [ ] タスクへのタグ付け（複数可）
- [ ] タグによるフィルタリング

### Phase 5: エクスポート

#### PDF出力
- [ ] ガントチャートのPDF出力
- [ ] 用紙サイズ・向きの選択
- [ ] 出力範囲の指定（日付範囲）

#### Excel/CSV出力
- [ ] WBSデータのExcel出力
- [ ] WBSデータのCSV出力
- [ ] 出力列の選択

## データ構造

### プロジェクトファイル（.gantty）

```json
{
  "version": "1.0",
  "project": {
    "name": "プロジェクト名",
    "createdAt": "2025-01-01T00:00:00Z",
    "updatedAt": "2025-01-01T00:00:00Z"
  },
  "settings": {
    "workingDays": [1, 2, 3, 4, 5],
    "holidays": ["2025-01-01", "2025-01-13"]
  },
  "resources": [
    {
      "id": "uuid",
      "name": "担当者名",
      "color": "#3B82F6",
      "capacity": 100
    }
  ],
  "customFields": [
    {
      "id": "uuid",
      "name": "フィールド名",
      "type": "text|number|date|select|checkbox",
      "options": ["選択肢1", "選択肢2"]
    }
  ],
  "tags": [
    {
      "id": "uuid",
      "name": "タグ名",
      "color": "#EF4444"
    }
  ],
  "tasks": [
    {
      "id": "uuid",
      "parentId": null,
      "name": "タスク名",
      "startDate": "2025-01-01",
      "endDate": "2025-01-05",
      "plannedHours": 40,
      "actualHours": 20,
      "progress": 50,
      "isMilestone": false,
      "resources": [
        {
          "resourceId": "uuid",
          "allocation": 100
        }
      ],
      "dependencies": [
        {
          "predecessorId": "uuid",
          "type": "FS",
          "lag": 0
        }
      ],
      "tags": ["uuid"],
      "customFields": {
        "field-uuid": "値"
      },
      "order": 0
    }
  ]
}
```

## UI構成

```
+----------------------------------------------------------+
|  メニューバー                                              |
+----------------------------------------------------------+
|  ツールバー（保存、元に戻す、スケール切替など）               |
+----------------------------------------------------------+
|                    |                                      |
|   WBS一覧          |   ガントチャート                       |
|   （左ペイン）      |   （右ペイン）                         |
|                    |                                      |
|   - タスク1        |   ████████                           |
|     - サブタスク   |      ████                            |
|   - タスク2        |          ██████████                  |
|                    |                                      |
+----------------------------------------------------------+
|  ステータスバー                                            |
+----------------------------------------------------------+
```

### 画面要素

#### メニューバー
- ファイル（新規、開く、保存、名前を付けて保存、エクスポート、終了）
- 編集（元に戻す、やり直し、カット、コピー、ペースト）
- 表示（スケール切替、リソース負荷表示）
- プロジェクト（リソース管理、カレンダー設定、カスタムフィールド設定）

#### ツールバー
- 新規タスク追加
- タスク削除
- インデント/アウトデント
- スケール切替（日/週/月）
- 今日に移動
- 依存関係追加モード

#### WBS一覧（左ペイン）
- 列: タスク名、開始日、終了日、工数、進捗率、担当者、（カスタムフィールド）
- 列幅調整可能
- 列の表示/非表示切り替え
- 行の右クリックメニュー

#### ガントチャート（右ペイン）
- タイムスケールヘッダー（2段: 月+日など）
- タスクバー
- 依存関係の矢印
- 今日のライン（赤い縦線）
- 非稼働日の背景色

## 制約事項

- **プラットフォーム**: Windows / macOS / Linux（Tauri対応）
- **言語**: 日本語のみ
- **テーマ**: ライトテーマのみ
- **データ保存**: ローカルファイルのみ（クラウド同期なし）
- **同時編集**: 非対応（ファイル共有は外部ツールで行う）

## 非機能要件

- **パフォーマンス**: 1000タスクでもスムーズに動作
- **ファイルサイズ**: プロジェクトファイルは可能な限り軽量に
- **自動保存**: 変更後30秒で自動保存（設定で無効化可能）

## 今後の検討事項

- チーム共有方法（Git連携、ファイル共有フォルダなど）
- ベースライン機能の追加
- 多言語対応
- ダークテーマ対応
- MS Project形式のインポート/エクスポート
