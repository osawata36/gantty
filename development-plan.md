# Gantty 開発計画

## 概要

この開発計画は、Ganttyアプリケーションをユーザーストーリー単位で段階的に構築するためのTODOリストです。
各ストーリーは独立して動作確認可能な単位で設計されており、早期からデモ可能な状態を維持します。

---

## Phase 0: プロジェクト基盤構築

### 0.1 開発環境セットアップ
- [x] Tauri v2 プロジェクトの初期化
- [x] React + TypeScript + Vite の設定
- [x] UIライブラリ（shadcn/ui）のセットアップ
- [x] 状態管理ライブラリ（Zustand）の導入
- [x] ESLint / Prettier の設定
- [x] 基本的なディレクトリ構造の作成

### 0.2 共通UIフレームワーク
- [x] アプリケーションシェル（メニューバー、ツールバー、ステータスバー）
- [x] ビュー切り替えの基本構造（タブ/ボタン）
- [x] 共通レイアウトコンポーネント

### 0.3 データ層の基盤
- [x] TypeScript型定義（Task, Resource, Project等）
- [x] Zustandストアの基本構造
- [x] .ganttyファイルの読み書きユーティリティ（Tauri FS API連携）

---

## Phase 1: MVP - ユーザーストーリー

### Story 1.1: プロジェクトファイルの作成と保存
**ゴール**: ユーザーが新規プロジェクトを作成し、ファイルとして保存できる

- [x] 新規プロジェクト作成ダイアログ
- [x] プロジェクト名の設定
- [x] ファイル保存ダイアログ（.gantty形式）
- [x] プロジェクトの読み込み機能
- [x] 空のプロジェクト状態の表示

**デモ確認ポイント**:
- アプリを起動し、新規プロジェクトを作成できる
- プロジェクトを保存し、再度開くことができる

---

### Story 1.2: 基本的なタスクの追加と表示（リストビュー）
**ゴール**: ユーザーがタスクを追加し、リスト形式で確認できる

- [x] タスク追加機能（タスク名のみ）
- [x] タスク一覧のリスト表示
- [x] タスク名のインライン編集
- [x] タスクの削除

**デモ確認ポイント**:
- タスクを追加してリストに表示される
- タスク名を編集できる
- タスクを削除できる

---

### Story 1.3: タスクの詳細属性設定
**ゴール**: ユーザーがタスクに詳細情報（日程、進捗等）を設定できる

- [x] タスク詳細パネル/モーダル
- [x] 開始日・終了日の設定（DatePicker）
- [x] 進捗率の設定（0-100%スライダー）
- [x] 工数（予定/実績）の設定
- [x] 説明文の入力（Markdown対応は後回し可）

**デモ確認ポイント**:
- タスクをクリックして詳細を編集できる
- 設定した日程や進捗がリストに反映される

---

### Story 1.4: タスクの階層構造（親子関係）
**ゴール**: ユーザーがタスクを階層化してWBSを構築できる

- [x] サブタスクの追加機能
- [x] インデント/アウトデントによる階層変更
- [x] ツリー構造の視覚的表示（インデント）
- [x] 折りたたみ/展開機能
- [x] 親タスクの日程・進捗の自動計算

**デモ確認ポイント**:
- タスクの下にサブタスクを作成できる
- 親タスクの日程が子タスクから自動計算される
- ツリーを折りたたみ/展開できる

---

### Story 1.5: メンバーの登録と割り当て
**ゴール**: ユーザーがメンバーを登録し、タスクに責任者・ボールを設定できる

- [x] メンバー管理画面（追加・編集・削除）
- [x] メンバーの名前と表示色の設定
- [x] タスクへの責任者（Responsible）の割り当て
- [x] タスクへのボール（Ball）保持者の割り当て
- [x] リストビューでの責任者・ボール表示

**デモ確認ポイント**:
- メンバーを登録できる
- タスクに責任者とボールを設定できる
- 誰がボールを持っているか一目でわかる

---

### Story 1.6: ステータス管理
**ゴール**: ユーザーがタスクにステータスを設定できる

- [x] デフォルトステータスの初期データ（未対応、処理中、レビュー待ち、完了）
- [x] タスクへのステータス設定
- [x] ステータス変更時の進捗率連動（完了→100%）
- [x] ステータスのカスタマイズ画面（名称・色・順序）

**デモ確認ポイント**:
- タスクのステータスを変更できる
- 「完了」にすると進捗が100%になる
- ステータスの名前や色をカスタマイズできる

---

### Story 1.7: ガントチャート基本表示
**ゴール**: ユーザーがタスクをガントチャート形式で視覚的に確認できる

- [x] ガントビューのレイアウト（左:WBS一覧、右:チャート）
- [x] タイムスケールヘッダー（日/週/月）
- [x] タスクバーの描画
- [x] 進捗率のバー内塗りつぶし表示
- [x] 今日の日付ライン
- [x] 横スクロール・縦スクロール

**デモ確認ポイント**:
- ガントビューに切り替えてタスクバーが表示される
- 日程がバーの位置・長さで表現される
- 進捗率がバー内の塗りつぶしで見える

---

### Story 1.8: ガントチャートでのドラッグ編集
**ゴール**: ユーザーがガントチャート上でタスクの日程を直感的に変更できる

- [x] バー全体のドラッグで日程移動
- [x] バーの端をドラッグで期間変更
- [x] ドラッグ中のプレビュー表示
- [x] 変更のストアへの反映

**デモ確認ポイント**:
- バーをドラッグして日程を変更できる
- バーの端を引っ張って期間を伸縮できる

---

### Story 1.9: ガントチャートの表示スケール切り替え
**ゴール**: ユーザーが表示スケールを切り替えて全体像や詳細を確認できる

- [x] 日表示モード
- [x] 週表示モード
- [x] 月表示モード
- [x] スケール切り替えボタン
- [x] 「今日に移動」ボタン

**デモ確認ポイント**:
- 日/週/月の表示を切り替えられる
- 「今日」ボタンで現在日にジャンプできる

---

### Story 1.10: カンバンビュー
**ゴール**: ユーザーがタスクをステータス別のカンバン形式で管理できる

- [x] カンバンビューのレイアウト
- [x] ステータス列の表示
- [x] タスクカードの表示（タスク名、責任者、ボール、進捗）
- [x] ドラッグ&ドロップによるステータス変更
- [x] リーフタスクのみ表示（親タスクは非表示）

**デモ確認ポイント**:
- カンバンビューでタスクがステータス別に並ぶ
- カードをドラッグしてステータスを変更できる

---

### Story 1.11: ボールのパスとフィルタリング
**ゴール**: ユーザーがボールを他のメンバーに渡し、誰がボールを持っているかでフィルタできる

- [x] ボールのパス機能（簡易UIまたは詳細パネルから）
- [x] ボール保持者でのフィルタリング
- [x] 「自分のボール」フィルタ

**デモ確認ポイント**:
- タスクのボールを別のメンバーに渡せる
- 特定のメンバーが持つボールだけを表示できる

---

### Story 1.12: タスクの並び替え
**ゴール**: ユーザーがタスクの順序をドラッグ&ドロップで変更できる

- [x] リストビューでのドラッグ&ドロップ並び替え
- [x] 階層構造を維持した並び替え
- [x] 順序の永続化

**デモ確認ポイント**:
- タスクをドラッグして順番を入れ替えられる

---

### Story 1.13: リストビューの列カスタマイズ
**ゴール**: ユーザーがリストビューで表示する列を選択できる

- [x] 列の表示/非表示設定
- [x] 列の順序変更
- [x] 列ごとのソート機能
- [x] 設定の永続化

**デモ確認ポイント**:
- 表示する列を選択できる
- 列をクリックしてソートできる

---

### Story 1.14: 自動保存
**ゴール**: ユーザーが保存を意識せずに作業を継続できる

- [x] 変更検知
- [x] 30秒後の自動保存実行
- [x] 自動保存の有効/無効設定
- [x] 保存中/保存済みのステータス表示

**デモ確認ポイント**:
- 編集後、自動的にファイルが保存される
- ステータスバーで保存状態がわかる

---

### Story 1.15: タスクの親子階層変更
**ゴール**: ユーザーがタスクの親子関係を後から自由に変更できる

- [x] タスクを別の親タスクの下にドラッグ&ドロップで移動
- [x] タスクをルートレベルに移動（親なしに変更）
- [x] 移動時の循環参照防止（自分の子孫を親にできない）
- [x] リストビューでのドラッグ&ドロップ対応

**デモ確認ポイント**:
- タスクをドラッグして別のタスクの子にできる
- 子タスクをドラッグしてルートレベルに戻せる

---

### Story 1.16: 初回プロジェクトなしで利用開始
**ゴール**: ユーザーが初回起動時にすぐにタスク入力を開始できる

- [x] アプリ起動時にデフォルト（無題）プロジェクトを自動作成
- [x] EmptyProjectState画面をスキップ
- [x] 初回保存時にプロジェクト名を設定するフロー
- [x] 未保存状態でも快適に作業可能

**デモ確認ポイント**:
- アプリを起動するとすぐにタスクを追加できる
- 保存時に初めてプロジェクト名を入力する

---

### Story 1.17: 所要日数によるタスク管理
**ゴール**: ユーザーが所要日数でタスクの期間を管理でき、ガントチャートで期間を維持したまま移動できる

- [x] タスクに所要日数（duration）フィールドを追加
- [x] 開始日と所要日数から終了日を自動計算
- [x] 終了日と所要日数から開始日を自動計算
- [x] 詳細パネルで所要日数の入力UI
- [x] ガントチャートで所要日数固定のままバーを移動

**デモ確認ポイント**:
- 所要日数を入力すると終了日が自動計算される
- ガントチャートでバーを移動しても所要日数（期間）が維持される

---

## Phase 2: 依存関係・マイルストーン・操作性向上

### Story 2.1: タスクの検索
**ゴール**: ユーザーがタスク名で素早くタスクを見つけられる

- [x] 検索ボックス
- [x] インクリメンタル検索
- [x] 検索結果のハイライト

**デモ確認ポイント**:
- 検索ボックスにタスク名を入力して検索できる

---

### Story 2.2: フィルタ機能
**ゴール**: ユーザーが条件でタスクを絞り込める

- [x] ステータスフィルタ
- [x] 責任者フィルタ
- [x] 期限フィルタ（今日、今週、遅延中）
- [x] 複数フィルタの組み合わせ
- [x] フィルタ条件の保存

**デモ確認ポイント**:
- 複数の条件でタスクを絞り込める

---

### Story 2.3: Undo/Redo
**ゴール**: ユーザーが操作を取り消してやり直せる

- [x] 操作履歴の管理
- [x] Ctrl/Cmd + Z で元に戻す
- [x] Ctrl/Cmd + Shift + Z でやり直し
- [x] Undo/Redoボタン

**デモ確認ポイント**:
- 操作を取り消せる
- 取り消した操作をやり直せる

---

### Story 2.4: キーボードショートカット
**ゴール**: ユーザーがキーボードで素早く操作できる

- [ ] Ctrl/Cmd + S: 保存
- [ ] Ctrl/Cmd + N: 新規タスク
- [ ] Delete: タスク削除
- [ ] Tab/Shift+Tab: インデント/アウトデント
- [ ] ↑/↓: タスク間移動
- [ ] Ctrl/Cmd + 1/2/3: ビュー切り替え
- [ ] ショートカット一覧表示

**デモ確認ポイント**:
- キーボードだけでタスク操作ができる

---

### Story 2.5: タスクの依存関係設定
**ゴール**: ユーザーがタスク間の依存関係を設定できる

- [x] 依存関係の種類選択（FS/SS/FF/SF）
- [x] ガントチャート上での矢印表示
- [x] 依存関係追加モード（クリックで接続）
- [x] ラグ/リードタイムの設定

**デモ確認ポイント**:
- タスク間に依存関係を設定できる
- ガントチャートに矢印が表示される

---

### Story 2.6: 依存関係による日程自動調整
**ゴール**: 先行タスクの変更が後続タスクに自動反映される

- [ ] 依存関係に基づく日程計算
- [ ] 先行タスク変更時の後続タスク日程更新
- [ ] 循環依存の検出と警告

**デモ確認ポイント**:
- 先行タスクの日程を変えると後続タスクも動く

---

### Story 2.7: マイルストーン
**ゴール**: ユーザーがプロジェクトの重要な節目を設定できる

- [ ] マイルストーンの作成（期間0日のタスク）
- [ ] マイルストーン専用アイコン（◆）表示
- [ ] マイルストーンへの依存関係設定

**デモ確認ポイント**:
- マイルストーンを作成してガントチャートに◆で表示される

---

### Story 2.8: クリティカルパス表示
**ゴール**: ユーザーがプロジェクト全体の遅延リスクを把握できる

- [ ] クリティカルパスの自動計算
- [ ] クリティカルパス上のタスクをハイライト

**デモ確認ポイント**:
- クリティカルパス上のタスクが強調表示される

---

## Phase 3: リソース管理（拡張）

### Story 3.1: リソースの稼働率設定
**ゴール**: ユーザーがメンバーの稼働率を設定できる

- [ ] リソースマスタに稼働率フィールド追加
- [ ] デフォルト100%

**デモ確認ポイント**:
- メンバーの稼働率を設定できる

---

### Story 3.2: タスクへの複数リソース割り当て
**ゴール**: ユーザーが1つのタスクに複数のメンバーを割り当てられる

- [ ] タスクへの複数リソース割り当てUI
- [ ] 割り当て率の設定（例: 50%）

**デモ確認ポイント**:
- タスクに複数のメンバーを割り当てられる

---

### Story 3.3: リソース負荷グラフ
**ゴール**: ユーザーがメンバーの負荷状況を確認できる

- [ ] リソース別の負荷グラフ表示
- [ ] 過負荷（100%超）の警告表示
- [ ] 期間ごとの負荷推移

**デモ確認ポイント**:
- 各メンバーの負荷がグラフで見える
- 過負荷の場合に警告が表示される

---

## Phase 4: カレンダー・カスタムフィールド

### Story 4.1: 非稼働日設定
**ゴール**: ユーザーが土日や祝日を非稼働日として設定できる

- [ ] 稼働曜日の設定（デフォルト: 月〜金）
- [ ] 祝日・休日の個別設定
- [ ] ガントチャートでの非稼働日グレー表示

**デモ確認ポイント**:
- 土日がグレー表示される
- 祝日を追加できる

---

### Story 4.2: 工数計算への非稼働日反映
**ゴール**: 工数計算が稼働日ベースで正確に行われる

- [ ] 工数計算に非稼働日を除外
- [ ] 期間と工数の整合性チェック

**デモ確認ポイント**:
- 5日間のタスクで土日を挟むと期間が7日になる

---

### Story 4.3: カスタムフィールド
**ゴール**: ユーザーが独自の項目をタスクに追加できる

- [ ] カスタムフィールドの定義（テキスト/数値/日付/選択肢/チェックボックス）
- [ ] タスクへのカスタムフィールド値設定
- [ ] リストビューでのカスタムフィールド列表示

**デモ確認ポイント**:
- 独自のフィールドを追加してタスクに値を設定できる

---

### Story 4.4: タグ機能
**ゴール**: ユーザーがタスクにタグを付けて分類できる

- [ ] タグの作成（名前・色）
- [ ] タスクへのタグ付け（複数可）
- [ ] タグによるフィルタリング

**デモ確認ポイント**:
- タスクにタグを付けられる
- タグでフィルタできる

---

## Phase 5: エクスポート

### Story 5.1: PDF出力
**ゴール**: ユーザーがガントチャートをPDFで共有できる

- [ ] ガントチャートのPDF出力
- [ ] 用紙サイズ・向きの選択
- [ ] 出力範囲の指定（日付範囲）

**デモ確認ポイント**:
- ガントチャートをPDFで出力できる

---

### Story 5.2: Excel/CSV出力
**ゴール**: ユーザーがWBSデータを他のツールで活用できる

- [ ] WBSデータのExcel出力
- [ ] WBSデータのCSV出力
- [ ] 出力列の選択

**デモ確認ポイント**:
- タスク一覧をExcel/CSVでエクスポートできる

---

## 推奨開発順序

1. **Phase 0** を最初に完了（基盤がないと何も動かない）
2. **Story 1.1 → 1.2 → 1.3** の順で基本的なタスク管理を構築
3. **Story 1.4** で階層構造を追加（WBSの核心機能）
4. **Story 1.5 → 1.6** でメンバーとステータス管理
5. **Story 1.7 → 1.8 → 1.9** でガントチャート機能
6. **Story 1.10** でカンバンビュー
7. 残りのPhase 1ストーリーを優先度に応じて
8. Phase 2以降はフィードバックに基づいて順序を調整

---

## 進捗記録

| Story | 開始日 | 完了日 | 備考 |
|-------|--------|--------|------|
| 0.1 開発環境セットアップ | 2024-12-24 | 2024-12-24 | Tauri v2, React, TypeScript, Vite, shadcn/ui, Zustand, ESLint, Prettier, Vitest |
| 0.2 共通UIフレームワーク | 2024-12-24 | 2024-12-24 | AppShell, ViewSwitcher |
| 0.3 データ層の基盤 | 2024-12-24 | 2024-12-24 | 型定義, projectStore, fileUtils |
| 1.1 プロジェクトファイルの作成と保存 | 2025-12-24 | 2025-12-24 | NewProjectDialog, useFileOperations, EmptyProjectState, Tauri dialog/fs plugins |
| 1.2 基本的なタスクの追加と表示 | 2025-12-24 | 2025-12-24 | TaskList, addTask/updateTask/deleteTask in projectStore, inline editing |
| 1.3 タスクの詳細属性設定 | 2025-12-24 | 2025-12-24 | TaskDetailPanel, DatePicker, Slider, 進捗・日程・工数の設定, リストでの表示 |
| 1.4 タスクの階層構造 | 2025-12-24 | 2025-12-24 | addSubTask, indent/outdent, getParentDates/Progress, toggleTaskCollapse, ツリー表示 |
| 1.5 メンバーの登録と割り当て | 2025-12-25 | 2025-12-26 | MemberManagementDialog, TaskDetailPanel(責任者・ボール), TaskList(バッジ表示) |
| 1.6 ステータス管理 | 2025-12-25 | 2025-12-25 | StatusCustomizationDialog, setTaskStatus, 進捗率連動 |
| 1.7 ガントチャート基本表示 | 2025-12-25 | 2025-12-25 | GanttView, タイムスケールヘッダー, タスクバー描画, 進捗表示, 今日ライン, スクロール |
| 1.8 ガントチャートでのドラッグ編集 | 2025-12-25 | 2025-12-25 | バー移動・期間変更, ドラッグプレビュー, ストア反映 |
| 1.9 ガントチャートの表示スケール切り替え | 2025-12-26 | 2025-12-26 | 日/週/月表示, スケール切り替えボタン, 今日に移動ボタン |
| 1.10 カンバンビュー | 2025-12-26 | 2025-12-26 | KanbanView, ステータス列, タスクカード, ドラッグ&ドロップ, リーフタスクフィルタ |
| 1.15 タスクの親子階層変更 | 2025-12-26 | 2025-12-26 | moveTask, 循環参照防止, リストビューでのドラッグ&ドロップUI |
| 1.16 初回プロジェクトなしで利用開始 | 2025-12-26 | 2025-12-26 | createDefaultProject, EmptyProjectStateスキップ, 未保存状態対応 |
| 1.17 所要日数によるタスク管理 | 2025-12-26 | 2025-12-26 | durationフィールド, 自動日付計算, TaskDetailPanelのUI |
| 1.11 ボールのパスとフィルタリング | 2025-12-26 | 2025-12-26 | ボールパス（TaskDetailPanel）, BallHolderFilter, currentUserId, getFilteredTasks |
| 1.12 タスクの並び替え | 2025-12-26 | 2025-12-26 | reorderTask, ドラッグ位置検出（before/child/after）, 視覚的インジケーター |
| 1.13 リストビューの列カスタマイズ | 2025-12-26 | 2025-12-26 | viewStore拡張, ColumnSettings, SortButton, 列表示/非表示, ソート機能 |
| 1.14 自動保存 | 2025-12-26 | 2025-12-26 | useAutoSave, saveStatus表示, 自動保存トグル, ステータスバー統合 |
| 2.1 タスクの検索 | 2025-12-26 | 2025-12-26 | SearchBox, viewStore(searchQuery), projectStore(getFilteredTasks), インクリメンタル検索, ハイライト |
| 2.2 フィルタ機能 | 2025-12-26 | 2025-12-26 | FilterDropdown, viewStore(filters), ステータス/責任者/期限フィルタ, 複数フィルタ組み合わせ, localStorage永続化 |
| 2.5 タスクの依存関係設定 | 2025-12-26 | 2025-12-26 | TaskDependency型, projectStore(依存関係CRUD), DependencyArrows, TaskDetailPanel(依存関係UI) |
| 2.3 Undo/Redo | 2025-12-30 | 2025-12-30 | historyStore, useHistory, キーボードショートカット(Cmd/Ctrl+Z), Undo/Redoボタン |
| ... | - | - | |

---

## 備考

- 各ストーリーは独立して動作確認可能な単位で設計
- ストーリー完了ごとにデモ可能な状態を維持
- フィードバックに基づいてストーリーの優先順位を随時調整可能
- Phase 0の基盤構築は必須だが、以降は柔軟に順序変更可能
